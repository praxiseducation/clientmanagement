<!-- Test Client List -->
<div class="test-container" style="padding: 20px;">
  <h2>Client List Test</h2>
  
  <button onclick="testBackendDirectly()" style="padding: 10px; background: #4285f4; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px;">
    Test Backend Function Directly
  </button>
  
  <button onclick="testSimpleFunction()" style="padding: 10px; background: #34a853; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px;">
    Test Simple Function
  </button>
  
  <button onclick="testGetSheets()" style="padding: 10px; background: #ea4335; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px;">
    Test Get Sheets
  </button>
  
  <div id="testResults" style="margin-top: 20px; padding: 10px; background: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; white-space: pre-wrap; font-family: monospace; font-size: 12px;">
    Results will appear here...
  </div>
</div>

<script>
function testBackendDirectly() {
  document.getElementById('testResults').textContent = 'Calling getAllClientsForDisplay...';
  
  google.script.run
    .withSuccessHandler(function(result) {
      document.getElementById('testResults').textContent = 
        'SUCCESS!\n' +
        'Clients found: ' + result.length + '\n\n' +
        JSON.stringify(result, null, 2);
    })
    .withFailureHandler(function(error) {
      document.getElementById('testResults').textContent = 
        'ERROR!\n' +
        'Message: ' + error.message + '\n' +
        'Stack: ' + error.stack + '\n' +
        'Full error: ' + JSON.stringify(error, null, 2);
    })
    .getAllClientsForDisplay();
}

function testSimpleFunction() {
  document.getElementById('testResults').textContent = 'Testing simple backend call...';
  
  google.script.run
    .withSuccessHandler(function(result) {
      document.getElementById('testResults').textContent = 
        'Simple test SUCCESS!\n' +
        'Result: ' + JSON.stringify(result, null, 2);
    })
    .withFailureHandler(function(error) {
      document.getElementById('testResults').textContent = 
        'Simple test ERROR!\n' +
        'Error: ' + error.toString();
    })
    .testSimpleBackend();
}

function testGetSheets() {
  document.getElementById('testResults').textContent = 'Getting sheet names...';
  
  google.script.run
    .withSuccessHandler(function(result) {
      document.getElementById('testResults').textContent = 
        'Sheets found: ' + result.length + '\n\n' +
        'Sheet names:\n' + result.join('\n');
    })
    .withFailureHandler(function(error) {
      document.getElementById('testResults').textContent = 
        'Error getting sheets!\n' +
        'Error: ' + error.toString();
    })
    .getAllSheetNames();
}
</script>